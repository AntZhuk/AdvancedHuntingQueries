# TTP Hunting Queries

Clicking on the name of the query will bring you to the file for it in this git repo.

***Or try them out right away in your M365 Security tenant:***

Click on the 'ðŸ”Ž' hotlink to plug the query right into your Advanced Hunting Query page

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAEAIWSS0vDUBCFz1rwP4S6UTB2L7goVaFQHwsXbtM02EheeJOoIP52vztpJNGWMrR37syZM3PmZqqpAm2Uao0lKrg9a4kFqhTpU5lKzjX3RB_8YjWqwZeGPZVTS2zD3REPfvEO_4aKmJpMF5rBV-GlRKIBQ4sXcc71oDud6VhHzOSneqOy65yD9bfAKv28NVbR49KwL3DURBut6BSDzomWIHyfFv_atNU6MR7PV3OGzJdh4R-toSH8Pvw0vra1uRMUtVsmZ7kvpnmnc7Kd7xZchncPT26RK33zP7Ht9bvoNjnZybCAPbW5uy0VqHskV1q1w_b3GL_F_z6V8bzaK_o9PsGUG2ttXJXOiQ719j18fEbE77Yx_cPMeL657T8nX7DDpWnocIe17a8d4xZke1XOvg6vZ8Ub7lL1A3NOUNvmAgAA&runQuery=true&timeRangeId=week) [Hidden XLL Payload](HiddenXLLPayload.kusto)
- Excel spawned by svchost.exe
- Used to bypass ASR rules and deliver payload through COM
- Implementation and writeup can be found at [optiv/Dent](https://github.com/optiv/Dent#remote-xll-payload-mode)

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA-1XUW_aQAz286T9h4gnKkWqwrS9TH3oOtAqUUCFag_TNGUJrGkDYZCNIe3H97PvAkm4hJDwsIcp4i7x2T77s89nLumSLOrSgCYY7_F-S0O6obG8MXWItwl9wqpFHzD2QfmM9z7Wx1h5Ta-gg7V45NIC83eaYuT3rVAjmoMW4NulGHMkXBHNZI8RrcnGmy98rvApygzvIXSx3Byzoka0wvgI2hojU9kC5otBH2N2weFhzaIr0bvVGgJQ2_SFWni-0gW9T9m-zsjN9C5T-i37x1i3xDL2K8RjgebCq_DAgiUkI-hh-lpGZcdH0RbIyijD003twpr-gnsjvq0EyR54Q_jB3yPB8HGHwLcdzu2M7xcaKdZn5Z472PK2kYYx8uGanDPo6MCSdxX0JLhM6Q_8Z7R8ycst8J5qhFs5XFs6wklkknwyRaSn1_7H4lyxSBC1UC-Wgtf-9Ocjs5DZkzVTdAayvhH7n4_G6B7jHLxsG9eXJsikdT2AJzwbPlmfLNRc9p6R8A5wUjXqCTRVgzaYY12pVF1lu37SL8FgKzJdXU1DRDaWasXWzTVytxi5yplzXEVuoOvuv5ZZ5Z61dlr2eD3L7EN-Boy4fkeYY_HYXLHVHTWBnLp5YsFiebLudM05l878aTmmV_n3pDPLxHkl2lxtKSPRNnDZRlmngN4poL9BnG1jrlgHp17ln8k6E59dIO8UrnRKbdnXmSQDzTipNTuVqU7mq5P5Kvc_fV5Mu6XX7Ry_c0Ap9890l5n2NPHZBfJO6Y7Z-_lGOr65VAMf_WQgmV0sfQ1JT04Cx2Qf9Wr8D0B_UcLNFTGQyqvuqQX9yNlr3t-EWF1ddgM7nEbS5ZlyqlaF9TmQSaJW14Z6qCjZppiY87seKkVnpb4dVZExSzfFpmrtqaepmmfm-lVf9li1VZ3AEBIB9LFW7k5Pk1A9aLEM96uqD-QbV9kci93RCXJjOQkr8bbcxqzcqRU636lX4xxJtxlX5D6GWF_Q4awrt6A6ltnO_k5njIsIspd-6e2vel7Oqp7sNwemPp6V1lLus4ccWeKnupZ0n1xNh_o3ajqHasXe8ZTf88l_0uIOJt2rOKLtBXdfvKWKEgAA&timeRangeId=week) [IOC Search](IOCSearch.kusto)
- Search for various IOCs (IPs, domains, filenames, hashes)
- Searches processes, file events, network connections, and email attachments

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA42U22rbQBCG57rQd3DcQGxQkp4DKYYUnItAKKWNr0IJqqQmTmxJWNs4gTx8v_0lq0pryWbZ0xz-2ZmdmZkl5qxnv21hM7uxkFNh36BGzFS8EXPA7YFbglyK1MxiVsccWM76CCVjj-2qwjpGq0BiYVM0rm3I_dJOrI8Vx8jhHtsh47ntA_afOiWcI-iHoGa2BGVlo4AWsd5jLRPd20ig9u0HdpbcHZr-3b-QWNhcrx3Bd_Kjz3uG9tJe2JPkb-RZwnm9Nz3bkTchN8fpr4W-vWKukHL4md0qfq4VbSW9imkKr1dHtIx4Lls-CleVr22RHrbgndm4wnJoTPWbg9rKpb0mVkMLpN37b4wll9hnNGL2uIEVVzwH6py9ifqmE3VCbp03kJoZ0kR5uwXKd8k65cpmxHediBf8pf__sM74Lqz3G7BC5Ld504dOnOd1cS79uy1QP3ai-trOVRNlNW_GOxLe-gzfR2KprGzL9UB1v1fj7YH2SWhjMO6x5zvNF2XTUu-6s1PoZfcparu3VQ5396pMErvwEyrf0UE8fw7dezupankkn3fl7bX60UGVU211fFFletkD5vCDf7ImUM00PQqlEagSU_WLqSTLCH-VhUiYBVUWMTI88n5MwE-lWb4qaGRV0JoZwZrf_QN39aNc4AUAAA&timeRangeId=week) [URLhaus Reported Network Connection](URLhausNetworkEvents.kusto)
- Imports the list of reported URLs from [URLhaus](https://urlhaus.abuse.ch/)
- Searches network events for remote connections matching reported URLs
